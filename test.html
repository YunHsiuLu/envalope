<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>婚禮邀請函</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #fce4ec;       
            --red-deep: #b71c1c;       
            --red-main: #d32f2f;       
            --red-flap: #c62828;       
            --gold: #fbc02d;           
            --paper-color: #fffaf0;    
            
            --env-width: 320px;
            --env-height: 480px;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            font-family: 'Noto Serif TC', serif;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .stage {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 2000px;
        }

        /* === 信封容器 === */
        .envelope-wrapper {
            position: relative;
            width: var(--env-width);
            height: var(--env-height);
            cursor: pointer;
            z-index: 10;
            transform-style: preserve-3d;
            transition: transform 1s ease, opacity 1s ease;
            box-shadow: 0 25px 45px rgba(0,0,0,0.2);
            animation: introFadeIn 1s ease-out forwards;
        }

        @keyframes introFadeIn {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* 1. 信封背板 */
        .envelope-back {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--red-deep);
            border-radius: 8px;
            z-index: 0;
        }

        /* 2. 信紙 (容器) */
        .letter {
            position: absolute;
            bottom: 5px; 
            left: 5%;
            width: 90%;
            height: 90%; 
            background-color: var(--paper-color);
            z-index: 5; 
            border-radius: 4px;
            transition: transform 1s cubic-bezier(0.6, -0.28, 0.735, 0.045); 
            
            /* [修改點 1] 確保內容絕對不會跑出圓角外，解決圖片看起來過大的感覺 */
            overflow: hidden;
            box-shadow: 0 -1px 5px rgba(0,0,0,0.05);
        }

        /* [修改點 2] 封面層 (test2.png) 設定 */
        .letter-cover {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2; /* 蓋在內文上面 */
            opacity: 1;
            background-color: var(--paper-color); /* 防止透明底 */
            
            /* 這裡定義一般的過渡效果 */
            transition: opacity 0.8s ease; 
        }

        .letter-cover img {
            width: 100%;
            height: 100%;
            /* 讓圖片填滿容器，如果覺得被裁切太多，可以改用 contain */
            object-fit: cover; 
            display: block;
        }

        /* [修改點 3] 內文層 (test1.png + 文字) */
        .letter-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* 放在封面下面 */
            
            /* 
               這裡改為 opacity: 1。
               因為封面層是不透明的，所以內文層一開始可以保持顯示狀態(在封面後面)。
               這樣當封面淡出時，內文自然就出現了，不需要額外的淡入動畫。
            */
            opacity: 1; 
            
            padding: 30px 20px;
            box-sizing: border-box;
            text-align: center;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            scrollbar-width: none; 
        }
        .letter-content::-webkit-scrollbar { display: none; }

        /* 
           [修改點 4 - 關鍵動畫邏輯] 
           當信紙變成全螢幕模式(full-mode)時的狀態 
        */
        .letter.full-mode .letter-cover {
            opacity: 0; /* 最終變透明 */
            pointer-events: none; /* 讓點擊穿透 */
            
            /* 
               關鍵：transition-delay: 0.8s
               意思是：等到「變大動畫(0.8s)」執行完畢後，才開始執行「淡出動畫」
            */
            transition: opacity 0.8s ease 1.5s;
        }

        /* 內文樣式保持不變 */
        .letter-content h1 {
            font-family: 'Playfair Display', serif;
            color: var(--red-deep);
            font-size: 1.8rem;
            margin: 0 0 15px 0;
        }

        .photo-area {
            width: 100%;
            max-width: 600px;
            height: 250px;
            background-color: #ddd;
            margin-bottom: 20px;
            border-radius: 4px;
            overflow: hidden;
            flex-shrink: 0;
            position: relative;
        }

        .photo-area img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .info { color: #333; line-height: 1.8; margin-bottom: 30px; }
        .invite-text { margin-bottom: 5px; color: #888; }
        .couple-names strong { color: var(--red-deep); font-size: 1.4em; }
        .divider { border-top: 1px dashed #ccc; margin: 20px 0; width: 100%; }
        .footer-text { margin-top: 30px; font-size: 0.9em; color: #999; }

        .btn-rsvp {
            display: inline-block;
            padding: 12px 35px;
            background-color: var(--red-main);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(211, 47, 47, 0.4);
            transition: 0.3s;
        }
        .btn-rsvp:hover { transform: translateY(-2px); background-color: var(--red-deep); }

        /* 3. 信封口袋 */
        .envelope-pocket {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--red-main);
            z-index: 10; 
            border-radius: 0 0 8px 8px;
            clip-path: polygon(0 0, 0% 100%, 100% 100%, 100% 0, 50% 35%);
            pointer-events: none;
        }

        /* 4. 信封蓋子 */
        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 35%;
            background-color: var(--red-flap);
            z-index: 20;
            border-radius: 8px 8px 0 0;
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            transform-origin: top;
            transition: 
                transform 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                z-index 0.1s linear 0.4s; 
        }

        /* 5. 封口貼 */
        .xixi-seal {
            position: absolute;
            top: 35%; 
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90px;
            height: 90px;
            background-color: var(--red-deep);
            border: 2px solid var(--gold);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 25;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .xixi-text {
            color: var(--gold);
            font-size: 55px;
            font-weight: bold;
            line-height: 1;
            user-select: none;
        }

        /* === 動畫狀態 === */

        .envelope-wrapper.open .xixi-seal {
            opacity: 0;
            transform: translate(-50%, -50%) scale(1.5);
        }

        .envelope-wrapper.open .envelope-flap {
            transform: rotateX(180deg);
            background-color: var(--red-deep);
            z-index: -1;
        }

        /* 抽出動畫 */
        .letter.extracted {
            transform: translateY(-200px);
            transition: transform 1.2s cubic-bezier(0.68, -0.3, 0.265, 1.3);
        }

        /* 信封淡出 */
        .envelope-wrapper.move-down {
            transform: translateY(100vh);
            opacity: 0;
            pointer-events: none;
        }

        /* 手機適配 */
        @media (max-width: 480px) {
            :root {
                --env-width: 280px;
                --env-height: 420px;
            }
            .xixi-seal { width: 70px; height: 70px; }
            .xixi-text { font-size: 40px; }
            .envelope-flap { height: 30%; } 
            .xixi-seal { top: 30%; }
        }
    </style>
</head>
<body>

    <div class="stage">
        <div class="envelope-wrapper" id="envelope">
            
            <!-- 1. 背板 -->
            <div class="envelope-back"></div>

            <!-- 2. 信紙 (夾層) -->
            <div class="letter" id="letter">
                
                <!-- [新增] 封面層：抽出時顯示這張圖 (test2.png) -->
                <div class="letter-cover">
                    <!-- 請將 src 改為您的 test2.png 路徑 -->
                    <img src="test2.png" alt="封面圖 test2">
                </div>

                <!-- 原本的內文層：展開後顯示 (包含 test1.png) -->
                <div class="letter-content">
                    <h1>Wedding Invitation</h1>
                    
                    <div class="photo-area">
                        <!-- 請將 src 改為您的 test1.png 路徑 -->
                        <img src="test1.png" alt="內文婚紗照 test1">
                    </div>

                    <div class="info">
                        <p class="invite-text">誠摯邀請您參與</p>
                        <p class="couple-names"><strong>王大明 & 陳小美</strong></p>
                        <p class="invite-text">的婚禮喜宴</p>
                        
                        <div class="divider"></div>
                        
                        <p>時間：2025年 5月 20日 (六) 18:30</p>
                        <p>地點：台北圓山大飯店</p>
                        <p>地址：台北市中山區中山北路四段1號</p>
                    </div>

                    <a href="https://forms.google.com/" target="_blank" class="btn-rsvp">
                        填寫出席意願 (RSVP)
                    </a>
                    
                    <p class="footer-text">期待您的蒞臨</p>
                </div>
            </div>

            <!-- 3. 口袋 -->
            <div class="envelope-pocket"></div>
            
            <!-- 4. 蓋子 -->
            <div class="envelope-flap"></div>
            
            <!-- 5. 封口貼 -->
            <div class="xixi-seal">
                <div class="xixi-text">囍</div>
            </div>

        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', () => {
    const envelopeWrapper = document.getElementById('envelope');
    const letter = document.getElementById('letter');
    let isOpened = false;

    envelopeWrapper.addEventListener('click', () => {
        if (isOpened) return;
        isOpened = true;

        // 1. 打開信封
        envelopeWrapper.classList.add('open');

        // 2. 抽出信紙 (抽出時，CSS 會顯示 letter-cover: test2.png)
        setTimeout(() => {
            letter.classList.add('extracted');
        }, 600);

        // 3. 全螢幕展開
        setTimeout(() => {
            
            // --- 步驟 A: 鎖定位置 ---
            const rect = letter.getBoundingClientRect();
            letter.style.transition = 'none';

            // 固定位置
            letter.style.position = 'fixed';
            letter.style.top = `${rect.top}px`;
            letter.style.left = `${rect.left}px`;
            letter.style.width = `${rect.width}px`;
            letter.style.height = `${rect.height}px`;
            letter.style.transform = 'none'; 
            
            // 移到最上層並掛載到 body
            letter.style.zIndex = '999';
            letter.style.margin = '0';
            document.body.appendChild(letter);

            // --- 步驟 B: 重繪 ---
            void letter.offsetWidth;

            // --- 步驟 C: 執行放大 ---
            letter.style.transition = 'all 1.5s cubic-bezier(0.25, 1, 0.5, 1)';
            
            requestAnimationFrame(() => {
                letter.style.top = '50%';
                letter.style.left = '50%';
                letter.style.width = '80vw';     
                letter.style.maxWidth = '800px'; 
                letter.style.height = '85vh';
                letter.style.transform = 'translate(-50%, -50%)';
                letter.style.borderRadius = '10px';
                
                // [關鍵] 加入 full-mode Class
                // CSS 會自動處理：cover (test2) 淡出 -> content (test1) 淡入
                letter.classList.add('full-mode');
            });

            // --- 步驟 D: 信封退場 ---
            envelopeWrapper.classList.add('move-down');
            document.body.style.overflow = 'auto';

        }, 1800); 
    });
});
    </script>
</body>
</html>
